<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title><%= extra.dashboard.title %></title>
	<link rel="icon" type="image/png" href="./assets/img/FlaxyNodes_logo.gif"/>
	
	<!-- Fonts and Icons -->
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	
	<!-- Tailwind CSS -->
	<link href="/assets/css/styles.css" rel="stylesheet">
	<script>
		tailwind.config = {
			darkMode: 'class',
			theme: {
				extend: {
					fontFamily: {
						sans: ['Poppins', 'sans-serif'],
					},
					colors: {
						primary: {
							50: '#eef2ff',
							100: '#e0e7ff',
							200: '#c7d2fe',
							300: '#a5b4fc',
							400: '#818cf8',
							500: '#6366f1',
							600: '#4f46e5',
							700: '#4338ca',
							800: '#3730a3',
							900: '#312e81',
							950: '#1e1b4b',
						},
						dark: {
							base: '#0f0f12',
							light: '#1a1a21',
							lighter: '#24242e',
							card: '#1a1a21'
						}
					},
					animation: {
						'fade-in': 'fadeIn 0.5s ease-in-out',
						'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
						'float': 'float 3s ease-in-out infinite',
					},
					keyframes: {
						fadeIn: {
							'0%': { opacity: '0' },
							'100%': { opacity: '1' },
						},
						float: {
							'0%, 100%': { transform: 'translateY(0)' },
							'50%': { transform: 'translateY(-10px)' },
						}
					},
					boxShadow: {
						'glow': '0 0 15px rgba(99, 102, 241, 0.5)',
						'card': '0 8px 24px rgba(0, 0, 0, 0.12)',
					}
				}
			}
		}
	</script>
	
	<style>
		body {
			background-color: #0f0f12;
			color: #f5f5f7;
			font-family: 'Poppins', sans-serif;
			background-image: radial-gradient(circle at 50% 50%, rgba(99, 102, 241, 0.1) 0%, transparent 50%);
			min-height: 100vh;
			display: flex;
			flex-direction: column;
		}
		
		.signature-font {
			font-family: 'Dancing Script', cursive;
			font-size: 18px;
		}
		
		/* Main layout wrapper */
		.dashboard-layout {
			display: flex;
			flex: 1;
			min-height: calc(100vh - 4rem); /* Subtract navbar height */
			position: relative;
		}
		
		/* Sidebar styles */
		.sidebar {
			background-color: rgba(22, 22, 24, 0.8);
			border-right: 1px solid rgba(45, 45, 53, 0.5);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
			position: fixed;
			left: 0;
			top: 4rem; /* Height of navbar */
			bottom: 0;
			width: 16rem; /* 64px */
			z-index: 40;
			transition: transform 0.3s ease;
		}
		
		/* Main content area */
		.main-content {
			flex: 1;
			margin-left: 16rem; /* Same as sidebar width */
			padding: 1rem;
			min-height: calc(100vh - 4rem);
			position: relative;
			z-index: 30;
		}
		
		/* Footer styles */
		footer {
			background: rgba(15, 15, 18, 0.8);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			border-top: 1px solid rgba(255, 255, 255, 0.05);
			width: 100%;
			z-index: 20;
			margin-top: auto;
		}
		
		.footer-content {
			max-width: 1200px;
			margin: 0 auto;
			padding: 1.5rem 1rem;
		}
		
		/* Custom scrollbar */
		::-webkit-scrollbar {
			width: 8px;
			height: 8px;
		}
		
		::-webkit-scrollbar-track {
			background: #1e1e24;
		}
		
		::-webkit-scrollbar-thumb {
			background: #3a3a43;
			border-radius: 4px;
		}
		
		::-webkit-scrollbar-thumb:hover {
			background: #4a4a55;
		}
		
		/* Custom styles */
		.bg-dark-card {
			background-color: rgba(26, 26, 31, 0.8);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			border: 1px solid rgba(255, 255, 255, 0.05);
		}
		
		.bg-dark-lighter {
			background-color: rgba(32, 32, 38, 0.8);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
		}
		
		.menu-item {
			transition: all 0.3s ease;
			position: relative;
			overflow: hidden;
		}
		
		.menu-item::before {
			content: '';
			position: absolute;
			left: 0;
			top: 0;
			height: 100%;
			width: 3px;
			background: #6366f1;
			transform: scaleY(0);
			transition: transform 0.3s ease;
		}
		
		.menu-item:hover::before {
			transform: scaleY(1);
		}
		
		.menu-item.active {
			background-color: rgba(99, 102, 241, 0.1);
			color: #fff;
		}
		
		.menu-item.active::before {
			transform: scaleY(1);
		}
		
		.menu-item.active i {
			color: #6366f1;
		}
		
		.navbar {
			background-color: rgba(15, 15, 18, 0.8);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			border-bottom: 1px solid rgba(45, 45, 53, 0.5);
			box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
		}
		
		.navbar-search {
			background-color: rgba(26, 26, 31, 0.8);
			border: 1px solid rgba(45, 45, 53, 0.8);
			transition: all 0.3s ease;
		}
		
		.navbar-search:focus {
			border-color: rgba(99, 102, 241, 0.5);
			box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.25);
		}
		
		.glass-card {
			background-color: rgba(26, 26, 31, 0.6);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			border: 1px solid rgba(255, 255, 255, 0.05);
			box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
		}
		
		.btn-primary {
			background: linear-gradient(135deg, #4f46e5 0%, #6366f1 100%);
			transition: all 0.3s ease;
			box-shadow: 0 4px 12px rgba(99, 102, 241, 0.25);
		}
		
		.btn-primary:hover {
			background: linear-gradient(135deg, #4338ca 0%, #4f46e5 100%);
			transform: translateY(-2px);
			box-shadow: 0 6px 16px rgba(99, 102, 241, 0.3);
		}
		
		.btn-primary:active {
			transform: translateY(0);
		}
		
		.resource-card {
			transition: transform 0.3s ease, box-shadow 0.3s ease;
			position: relative;
		}
		
		.resource-card:hover {
			transform: translateY(-5px);
			box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
		}
		
		.gradient-border {
			position: relative;
			border-radius: 0.75rem;
			overflow: hidden;
		}
		
		.gradient-border::before {
			content: '';
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			border-radius: 0.75rem;
			padding: 2px;
			background: linear-gradient(45deg, #6366f1, #818cf8, #4f46e5);
			-webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
			-webkit-mask-composite: xor;
			mask-composite: exclude;
			z-index: 0;
			opacity: 0.3;
			transition: opacity 0.3s ease;
		}
		
		.gradient-border:hover::before {
			opacity: 1;
		}
		
		.resource-progress {
			height: 8px;
			background-color: rgba(45, 45, 53, 0.5);
			border-radius: 4px;
			margin-bottom: 10px;
			overflow: hidden;
		}
		
		.resource-progress-bar {
			height: 100%;
			border-radius: 4px;
			transition: width 0.5s ease;
		}
		
		.resource-progress-bar.ram {
			background: linear-gradient(to right, #4f46e5, #818cf8);
		}
		
		.resource-progress-bar.disk {
			background: linear-gradient(to right, #10b981, #34d399);
		}
		
		.resource-progress-bar.cpu {
			background: linear-gradient(to right, #f59e0b, #fbbf24);
		}
		
		.resource-progress-bar.servers {
			background: linear-gradient(to right, #8b5cf6, #a78bfa);
		}
		
		.resource-stats {
			display: flex;
			justify-content: space-between;
			font-size: 0.875rem;
			color: #a1a1aa;
		}
		
		.resource-icon {
			transition: all 0.3s ease;
		}
		
		.resource-card:hover .resource-icon {
			transform: scale(1.1);
		}
		
		.animate-slide-up {
			animation: slideUp 0.5s ease-out forwards;
		}
		
		@keyframes slideUp {
			from {
				opacity: 0;
				transform: translateY(20px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}
		
		.card {
			transition: all 0.3s ease;
		}
		
		.card:hover {
			transform: translateY(-5px);
			box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
		}
		
		/* Mobile Responsive Styles */
		@media (max-width: 767px) {
			.sidebar {
				transform: translateX(-100%);
				width: 80%; /* Wider sidebar on mobile */
				max-width: 16rem;
			}
			
			.sidebar.active {
				transform: translateX(0);
			}
			
			.main-content {
				margin-left: 0;
				width: 100%;
				padding: 0.5rem;
			}
			
			#mobileMenuBtn {
				display: flex;
				background-color: rgba(26, 26, 31, 0.8);
				border: 1px solid rgba(45, 45, 53, 0.5);
				transition: all 0.3s ease;
			}
			
			#mobileMenuBtn:hover {
				background-color: rgba(26, 26, 31, 0.95);
				border-color: rgba(255, 255, 255, 0.2);
			}

			#mobileMenuBtn:active {
				transform: scale(0.95);
			}

			#mobileMenuBtn i {
				transition: transform 0.3s ease;
				font-size: 1.25rem;
			}

			#mobileMenuBtn.active i {
				transform: rotate(180deg);
			}
			
			/* Improved mobile padding */
			.p-6 {
				padding: 1rem;
			}
			
			/* Adjust text sizes for mobile */
			.text-3xl {
				font-size: 1.5rem;
			}
			
			.text-xl {
				font-size: 1.25rem;
			}
			
			/* Adjust footer for mobile */
			.footer-content {
				padding: 1rem 0.5rem;
			}
			
			.footer-links {
				margin-top: 1rem;
				display: flex;
				flex-wrap: wrap;
				justify-content: center;
				gap: 1rem;
			}
			
			/* Fix overflow issues on mobile */
			.overflow-x-auto {
				-webkit-overflow-scrolling: touch;
			}
		}
		
		/* Small screen adjustments */
		@media (max-width: 639px) {
			.resource-card {
				margin-bottom: 0.5rem;
			}
			
			.card {
				margin-bottom: 0.5rem;
			}
			
			.glass-card {
				padding: 1rem !important;
			}
			
			/* Adjust spacing for mobile */
			.mb-8 {
				margin-bottom: 1rem;
			}
			
			.gap-6 {
				gap: 0.75rem;
			}
			
			/* Better table display on mobile */
			table {
				display: block;
				overflow-x: auto;
				white-space: nowrap;
			}
			
			/* Adjust welcome message for mobile */
			.mt-16 {
				margin-top: 5rem;
			}
		}
		
		/* Medium screen adjustments */
		@media (min-width: 768px) and (max-width: 1023px) {
			.main-content {
				margin-left: 16rem;
				padding: 0.75rem;
			}
			
			.gap-6 {
				gap: 1rem;
			}
		}
		
		/* Tablet portrait mode */
		@media (min-width: 640px) and (max-width: 767px) {
			.grid-cols-1 {
				grid-template-columns: repeat(2, minmax(0, 1fr));
			}
		}
	</style>
</head>
<body class="min-h-screen">
	<!-- Calculate server resources -->
	<%
		let ram = 0;
		let disk = 0;
		let cpu = 0;
		let servers = 0;
		
		if (pterodactyl && pterodactyl.relationships && pterodactyl.relationships.servers && pterodactyl.relationships.servers.data) {
			servers = pterodactyl.relationships.servers.data.length;
			
			for (let i = 0, len = pterodactyl.relationships.servers.data.length; i < len; i++) {
				ram = ram + (typeof pterodactyl.relationships.servers.data[i].attributes.limits.memory == "number" ? pterodactyl.relationships.servers.data[i].attributes.limits.memory : 0);
				disk = disk + (typeof pterodactyl.relationships.servers.data[i].attributes.limits.disk == "number" ? pterodactyl.relationships.servers.data[i].attributes.limits.disk : 0);
				cpu = cpu + (typeof pterodactyl.relationships.servers.data[i].attributes.limits.cpu == "number" ? pterodactyl.relationships.servers.data[i].attributes.limits.cpu : 0);
			}
		}
		
		const userData = {
			id: userinfo.id,
			username: userinfo.username || userinfo.email.split('@')[0],
			email: userinfo.email,
			isAdmin: typeof req.session !== 'undefined' ? req.session.isAdmin : false
		};
		
		const packageData = typeof packages !== 'undefined' ? packages : {
			ram: 0,
			disk: 0,
			cpu: 0,
			servers: 0
		};
		
		// Calculate total resources (package + extra)
		const extraData = typeof extraresources !== 'undefined' ? extraresources : {
			ram: 0,
			disk: 0,
			cpu: 0,
			servers: 0
		};
		
		const totalRam = packageData.ram + extraData.ram;
		const totalDisk = packageData.disk + extraData.disk;
		const totalCpu = packageData.cpu + extraData.cpu;
		const totalServers = packageData.servers + extraData.servers;
		
		// Available resources
		const availableRam = totalRam - ram;
		const availableDisk = totalDisk - disk;
		const availableCpu = totalCpu - cpu;
		const availableServers = totalServers - servers;
	%>

	<!-- Navbar -->
	<nav class="navbar fixed w-full h-16 z-50 px-4 py-2.5 flex items-center justify-between">
		<!-- Left side - Logo and Brand -->
		<div class="flex items-center">
			<a href="/" class="flex items-center group">
				<div class="h-10 w-10 mr-2 sm:mr-3 rounded-full overflow-hidden transition-all duration-300 group-hover:shadow-glow">
					<img src="/assets/img/FlaxyNodes_logo.gif" class="h-full w-full object-cover" alt="Flaxy Nodes Logo">
				</div>
				<div class="flex flex-col">
					<span class="self-center text-sm sm:text-base md:text-xl font-bold text-white truncate max-w-[100px] sm:max-w-full">Flaxy Nodes</span>
					<span class="text-[10px] sm:text-xs text-indigo-300 hidden xs:block">Premium Game Hosting</span>
				</div>
			</a>
		</div>

		<!-- Center - Search Bar -->
		<div class="hidden md:flex items-center flex-1 max-w-xl mx-8">
			<div class="relative w-full">
				<input type="text" placeholder="Search servers..." class="navbar-search w-full px-4 py-2 rounded-lg text-white placeholder-gray-400 focus:outline-none">
				<button class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white transition-colors duration-200">
					<i class="fas fa-search"></i>
				</button>
			</div>
		</div>

		<!-- Right side - User Menu and Notifications -->
		<div class="flex items-center gap-4">
			<!-- Notifications -->
			<div class="relative">
				<button class="p-2 text-gray-400 hover:text-white transition-colors duration-200">
					<i class="fas fa-bell"></i>
					<span class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full animate-pulse"></span>
				</button>
			</div>
			
			<!-- Mobile Search Button -->
			<button id="mobileSearchBtn" class="md:hidden p-2 text-gray-400 hover:text-white transition-colors duration-200">
				<i class="fas fa-search"></i>
			</button>

			<!-- User Profile Dropdown -->
			<div class="relative inline-block">
				<button id="dropdownBtn" class="flex items-center px-2 sm:px-4 py-2 text-sm font-medium text-white rounded-lg bg-dark-lighter hover:bg-primary-700 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-opacity-50">
					<div class="w-8 h-8 rounded-full bg-primary-500/20 flex items-center justify-center mr-3">
						<i class="fas fa-user text-primary-400"></i>
					</div>
					<span class="hidden sm:inline-block ml-2 mr-2"><%= userData.username %></span>
					<svg class="w-4 h-4 hidden sm:inline-block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
					</svg>
				</button>
				<div id="dropdownMenu" class="hidden absolute right-0 mt-2 w-64 bg-dark-lighter rounded-lg shadow-lg overflow-hidden z-50 border border-gray-700 transform transition-all duration-200 ease-in-out">
					<div class="p-4 border-b border-gray-700">
						<div class="flex items-center">
							<div class="w-10 h-10 rounded-full bg-primary-500/20 flex items-center justify-center mr-3">
								<i class="fas fa-user text-primary-400"></i>
							</div>
							<div>
								<p class="text-sm font-medium text-white"><%= userData.username %></p>
								<p class="text-xs text-gray-400"><%= userData.email %></p>
							</div>
						</div>
					</div>
					<ul class="py-1 text-sm text-gray-200">
						<li>
							<a href="/settings" class="flex items-center px-4 py-2 hover:bg-dark-base hover:text-primary-400 transition-colors duration-200">
								<i class="fas fa-cog mr-2"></i> Settings
							</a>
						</li>
						<li>
							<a href="/profile" class="flex items-center px-4 py-2 hover:bg-dark-base hover:text-primary-400 transition-colors duration-200">
								<i class="fas fa-user-circle mr-2"></i> Profile
							</a>
						</li>
						<% if (userData.isAdmin) { %>
						<li>
							<a href="/admin" class="flex items-center px-4 py-2 hover:bg-dark-base hover:text-primary-400 transition-colors duration-200">
								<i class="fas fa-shield-alt mr-2"></i> Admin Panel
							</a>
						</li>
						<% } %>
						<li class="border-t border-gray-700 mt-1">
							<a href="/auth/logout" class="flex items-center px-4 py-2 hover:bg-dark-base text-red-400 hover:text-red-300 transition-colors duration-200">
								<i class="fas fa-sign-out-alt mr-2"></i> Logout
							</a>
						</li>
					</ul>
				</div>
			</div>

			<!-- Mobile Menu Button -->
			<button id="mobileMenuBtn" class="md:hidden p-2 text-gray-400 hover:text-white transition-colors duration-200">
				<i class="fas fa-bars"></i>
			</button>

			<!-- Mobile Search Bar -->
			<div id="mobileSearch" class="md:hidden fixed top-16 left-0 right-0 p-4 bg-dark-base border-b border-gray-800 z-40 hidden">
				<div class="relative">
					<input type="text" placeholder="Search servers..." class="w-full px-4 py-2 bg-dark-lighter rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500">
					<button class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white">
						<i class="fas fa-search"></i>
					</button>
				</div>
			</div>
		</div>
	</nav>

	<div class="dashboard-layout">
		<!-- Sidebar -->
		<aside class="sidebar">
			<div class="h-full px-3 pb-4 overflow-y-auto flex flex-col">
				<ul class="space-y-1 pt-4 font-medium flex-grow">
					<li>
						<a href="/dashboard" class="menu-item flex items-center p-3 text-white rounded-lg active">
							<i class="fas fa-tachometer-alt w-5 h-5 text-primary-400 transition duration-75"></i>
							<span class="ml-3">Dashboard</span>
						</a>
					</li>
					<li>
						<a href="/servers" class="menu-item flex items-center p-3 text-gray-300 rounded-lg hover:text-white">
							<i class="fas fa-server w-5 h-5 text-gray-400 transition duration-75 group-hover:text-primary-400"></i>
							<span class="ml-3">Servers</span>
						</a>
					</li>
					<li>
						<a href="/store" class="menu-item flex items-center p-3 text-gray-300 rounded-lg hover:text-white">
							<i class="fas fa-shopping-cart w-5 h-5 text-gray-400 transition duration-75 group-hover:text-primary-400"></i>
							<span class="ml-3">Store</span>
						</a>
					</li>
					<li>
						<a href="/afk" class="menu-item flex items-center p-3 text-gray-300 rounded-lg hover:text-white">
							<i class="fas fa-coins w-5 h-5 text-gray-400 transition duration-75 group-hover:text-primary-400"></i>
							<span class="ml-3">AFK Page</span>
						</a>
					</li>
					<li>
						<a href="/redeem" class="menu-item flex items-center p-3 text-gray-300 rounded-lg hover:text-white">
							<i class="fas fa-gift w-5 h-5 text-gray-400 transition duration-75 group-hover:text-primary-400"></i>
							<span class="ml-3">Redeem</span>
						</a>
					</li>
					<li>
						<a href="/earn" class="menu-item flex items-center p-3 text-gray-300 rounded-lg hover:text-white">
							<i class="fas fa-gem w-5 h-5 text-gray-400 transition duration-75 group-hover:text-primary-400"></i>
							<span class="ml-3">Earn</span>
						</a>
					</li>
					<li>
						<a href="/leaderboard" class="menu-item flex items-center p-3 text-gray-300 rounded-lg hover:text-white">
							<i class="fas fa-trophy w-5 h-5 text-gray-400 transition duration-75 group-hover:text-primary-400"></i>
							<span class="ml-3">Leaderboard</span>
						</a>
					</li>
					<li>
						<a href="/settings" class="menu-item flex items-center p-3 text-gray-300 rounded-lg hover:text-white">
							<i class="fas fa-cog w-5 h-5 text-gray-400 transition duration-75 group-hover:text-primary-400"></i>
							<span class="ml-3">Settings</span>
						</a>
					</li>
					<li>
						<a href="<%= settings.pterodactyl.domain %>" target="_blank" class="menu-item flex items-center p-3 text-gray-300 rounded-lg hover:text-white">
							<i class="fas fa-external-link-alt w-5 h-5 text-gray-400 transition duration-75 group-hover:text-primary-400"></i>
							<span class="ml-3">Panel</span>
						</a>
					</li>
					<% if (userData.isAdmin) { %>
					<li class="mt-6 pt-6 border-t border-gray-700">
						<a href="/admin" class="menu-item flex items-center p-3 text-gray-300 rounded-lg hover:text-white">
							<i class="fas fa-shield-alt w-5 h-5 text-red-400 transition duration-75 group-hover:text-red-300"></i>
							<span class="ml-3">Admin Panel</span>
						</a>
					</li>
					<% } %>
				</ul>
				
				<!-- Developer Signature -->
				<div class="mt-auto border-t border-gray-700 pt-4 pb-2">
					<div class="text-center">
						<p class="text-sm text-gray-400 font-poppins">Made by Prathmesh &lt;/&gt;</p>
						<p class="text-sm text-primary-400 signature-font mt-1">~ Prathmesh</p>
					</div>
				</div>
			</div>
		</aside>
		
		<!-- Main Content -->
		<main class="main-content">
			<div class="p-4">
				<!-- Welcome Message -->
				<div class="mb-8 glass-card p-6 rounded-xl animate-fade-in mt-16">
					<h1 class="text-3xl font-bold mb-2">Welcome back, <span class="text-primary-400"><%= userData.username %></span>!</h1>
					<p class="text-gray-400">Here's an overview of your server resources and recent activity.</p>
				</div>
				<!-- Stats Cards -->
				<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8 animate-slide-up" style="animation-delay: 0.1s;">
					<!-- RAM Card -->
					<div class="resource-card gradient-border">
						<div class="stat-card h-full bg-dark-card rounded-lg p-6">
							<div class="flex items-center justify-between mb-4">
								<div class="flex items-center">
									<div class="resource-icon w-12 h-12 rounded-lg bg-blue-500/20 flex items-center justify-center mr-3">
										<i class="fas fa-memory text-blue-400 text-xl"></i>
									</div>
									<div>
										<h3 class="text-lg font-medium">RAM</h3>
										<p class="text-gray-400 text-sm">Memory Usage</p>
									</div>
								</div>
								<div class="text-right">
									<span class="text-2xl font-bold"><%= Math.round((ram / (packageData.ram + extraData.ram)) * 100) %>%</span>
								</div>
							</div>
							<div class="resource-progress">
								<div class="resource-progress-bar ram" style="width: <%= Math.round((ram / (packageData.ram + extraData.ram)) * 100) %>%"></div>
							</div>
							<div class="resource-stats">
								<span><%= ram %> MB used</span>
								<span><%= packageData.ram + extraData.ram %> MB total</span>
							</div>
						</div>
					</div>
					
					<!-- Disk Card -->
					<div class="resource-card gradient-border">
						<div class="stat-card h-full bg-dark-card rounded-lg p-6">
							<div class="flex items-center justify-between mb-4">
								<div class="flex items-center">
									<div class="resource-icon w-12 h-12 rounded-lg bg-green-500/20 flex items-center justify-center mr-3">
										<i class="fas fa-hdd text-green-400 text-xl"></i>
									</div>
									<div>
										<h3 class="text-lg font-medium">Disk</h3>
										<p class="text-gray-400 text-sm">Storage Usage</p>
									</div>
								</div>
								<div class="text-right">
									<span class="text-2xl font-bold"><%= Math.round((disk / (packageData.disk + extraData.disk)) * 100) %>%</span>
								</div>
							</div>
							<div class="resource-progress">
								<div class="resource-progress-bar disk" style="width: <%= Math.round((disk / (packageData.disk + extraData.disk)) * 100) %>%"></div>
							</div>
							<div class="resource-stats">
								<span><%= disk %> MB used</span>
								<span><%= packageData.disk + extraData.disk %> MB total</span>
							</div>
						</div>
					</div>
					
					<!-- CPU Card -->
					<div class="resource-card gradient-border">
						<div class="stat-card h-full bg-dark-card rounded-lg p-6">
							<div class="flex items-center justify-between mb-4">
								<div class="flex items-center">
									<div class="resource-icon w-12 h-12 rounded-lg bg-amber-500/20 flex items-center justify-center mr-3">
										<i class="fas fa-microchip text-amber-400 text-xl"></i>
									</div>
									<div>
										<h3 class="text-lg font-medium">CPU</h3>
										<p class="text-gray-400 text-sm">Processor Usage</p>
									</div>
								</div>
								<div class="text-right">
									<span class="text-2xl font-bold"><%= Math.round((cpu / (packageData.cpu + extraData.cpu)) * 100) %>%</span>
								</div>
							</div>
							<div class="resource-progress">
								<div class="resource-progress-bar cpu" style="width: <%= Math.round((cpu / (packageData.cpu + extraData.cpu)) * 100) %>%"></div>
							</div>
							<div class="resource-stats">
								<span><%= cpu %>% used</span>
								<span><%= packageData.cpu + extraData.cpu %>% total</span>
							</div>
						</div>
					</div>
					
					<!-- Servers Card -->
					<div class="resource-card gradient-border">
						<div class="stat-card h-full bg-dark-card rounded-lg p-6">
							<div class="flex items-center justify-between mb-4">
								<div class="flex items-center">
									<div class="resource-icon w-12 h-12 rounded-lg bg-purple-500/20 flex items-center justify-center mr-3">
										<i class="fas fa-server text-purple-400 text-xl"></i>
									</div>
									<div>
										<h3 class="text-lg font-medium">Servers</h3>
										<p class="text-gray-400 text-sm">Active Instances</p>
									</div>
								</div>
								<div class="text-right">
									<span class="text-2xl font-bold"><%= Math.round((servers / (packageData.servers + extraData.servers)) * 100) %>%</span>
								</div>
							</div>
							<div class="resource-progress">
								<div class="resource-progress-bar servers" style="width: <%= Math.round((servers / (packageData.servers + extraData.servers)) * 100) %>%"></div>
							</div>
							<div class="resource-stats">
								<span><%= servers %> used</span>
								<span><%= packageData.servers + extraData.servers %> total</span>
							</div>
						</div>
					</div>
				</div>
				
				<!-- Quick Actions -->
				<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
					<div class="card rounded-xl p-6 bg-dark-card border border-gray-700 hover:border-primary-500/30 transition-all duration-300">
						<div class="w-14 h-14 rounded-xl bg-primary-500/20 flex items-center justify-center mb-5">
							<i class="fas fa-plus text-primary-400 text-xl"></i>
						</div>
						<h3 class="text-xl font-semibold mb-2">Create Server</h3>
						<p class="text-gray-400 mb-5">Deploy a new game server with your available resources.</p>
						<a href="/create" class="btn-primary inline-flex items-center px-4 py-2 rounded-lg text-white font-medium text-sm">
							Create Now
							<i class="fas fa-arrow-right ml-2"></i>
						</a>
					</div>
					
					<div class="card rounded-xl p-6 bg-dark-card border border-gray-700 hover:border-primary-500/30 transition-all duration-300">
						<div class="w-14 h-14 rounded-xl bg-purple-500/20 flex items-center justify-center mb-5">
							<i class="fas fa-coins text-purple-400 text-xl"></i>
						</div>
						<h3 class="text-xl font-semibold mb-2">Earn Credits</h3>
						<p class="text-gray-400 mb-5">Complete tasks to earn credits for your account.</p>
						<a href="/earn" class="inline-flex items-center px-4 py-2 rounded-lg bg-purple-600 hover:bg-purple-700 text-white font-medium text-sm transition-all duration-300">
							Start Earning
							<i class="fas fa-arrow-right ml-2"></i>
						</a>
					</div>
					
					<div class="card rounded-xl p-6 bg-dark-card border border-gray-700 hover:border-primary-500/30 transition-all duration-300">
						<div class="w-14 h-14 rounded-xl bg-emerald-500/20 flex items-center justify-center mb-5">
							<i class="fas fa-shopping-cart text-emerald-400 text-xl"></i>
						</div>
						<h3 class="text-xl font-semibold mb-2">Resource Store</h3>
						<p class="text-gray-400 mb-5">Purchase additional resources for your servers.</p>
						<a href="/store" class="inline-flex items-center px-4 py-2 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white font-medium text-sm transition-all duration-300">
							Visit Store
							<i class="fas fa-arrow-right ml-2"></i>
						</a>
					</div>
				</div>
				
				<!-- Server List -->
				<div class="glass-card rounded-xl border border-gray-700 p-6 mb-8">
					<div class="flex flex-col md:flex-row md:items-center justify-between mb-6">
						<h2 class="text-xl font-semibold flex items-center mb-3 md:mb-0">
							<i class="fas fa-server text-primary-400 mr-3"></i>
							Your Servers
						</h2>
						<div class="flex space-x-2">
							<a href="/create" class="btn-primary py-2 px-4 rounded-lg text-white flex items-center text-sm">
								<i class="fas fa-plus mr-2"></i>
								New Server
							</a>
							<button class="bg-dark-lighter hover:bg-gray-700 py-2 px-4 rounded-lg text-white flex items-center text-sm transition-all duration-200">
								<i class="fas fa-filter mr-2"></i>
								Filter
							</button>
						</div>
					</div>
					
					<div class="overflow-x-auto -mx-4 md:mx-0">
						<table class="min-w-full text-sm text-left text-gray-400">
							<thead class="text-xs uppercase bg-gray-800 text-gray-400">
								<tr>
									<th scope="col" class="py-3 px-4 md:px-6">Server Name</th>
									<th scope="col" class="py-3 px-4 md:px-6">Status</th>
									<th scope="col" class="py-3 px-4 md:px-6 hidden sm:table-cell">RAM</th>
									<th scope="col" class="py-3 px-4 md:px-6 hidden sm:table-cell">Disk</th>
									<th scope="col" class="py-3 px-4 md:px-6 hidden md:table-cell">CPU</th>
									<th scope="col" class="py-3 px-4 md:px-6">Actions</th>
								</tr>
							</thead>
							<tbody>
								<% if (pterodactyl && pterodactyl.relationships && pterodactyl.relationships.servers && pterodactyl.relationships.servers.data && pterodactyl.relationships.servers.data.length > 0) { %>
									<% for(let i = 0; i < pterodactyl.relationships.servers.data.length; i++) { 
										const server = pterodactyl.relationships.servers.data[i].attributes;
										const serverRam = typeof server.limits.memory == "number" ? server.limits.memory : 0;
										const serverDisk = typeof server.limits.disk == "number" ? server.limits.disk : 0;
										const serverCpu = typeof server.limits.cpu == "number" ? server.limits.cpu : 0;
										const serverStatus = server.status || 'offline';
										const statusClass = serverStatus === 'running' ? 'bg-green-900/30 text-green-400' : 
											serverStatus === 'starting' ? 'bg-amber-900/30 text-amber-400' : 'bg-red-900/30 text-red-400';
										const statusIcon = serverStatus === 'running' ? 'circle' : 
											serverStatus === 'starting' ? 'exclamation-circle' : 'times-circle';
										const statusText = serverStatus === 'running' ? 'Running' : 
											serverStatus === 'starting' ? 'Starting' : 'Offline';
									%>
								<tr class="border-b border-gray-700 hover:bg-gray-800/50 transition-colors duration-200">
									<td class="py-3 px-4 md:px-6 font-medium text-white">
										<div class="flex items-center">
											<div class="w-8 h-8 rounded-full bg-primary-500/20 flex items-center justify-center mr-3 flex-shrink-0">
												<i class="fas fa-server text-primary-400"></i>
											</div>
											<div>
												<div class="font-medium"><%= server.name %></div>
												<div class="text-xs text-gray-500">ID: <%= server.identifier %></div>
											</div>
										</div>
									</td>
									<td class="py-3 px-4 md:px-6">
										<span class="px-2 py-1 text-xs rounded-full <%= statusClass %>">
											<i class="fas fa-<%= statusIcon %> mr-1"></i>
											<%= statusText %>
										</span>
									</td>
									<td class="py-3 px-4 md:px-6 hidden sm:table-cell">
										<div class="flex items-center">
											<div class="w-full bg-gray-700 rounded-full h-2 mr-2 max-w-[100px]">
												<div class="bg-primary-500 h-2 rounded-full" style="width: <%= Math.round((serverRam / (packageData.ram + extraData.ram)) * 100) %>%"></div>
											</div>
											<span><%= serverRam %> MB</span>
										</div>
									</td>
									<td class="py-3 px-4 md:px-6 hidden sm:table-cell">
										<div class="flex items-center">
											<div class="w-full bg-gray-700 rounded-full h-2 mr-2 max-w-[100px]">
												<div class="bg-green-500 h-2 rounded-full" style="width: <%= Math.round((serverDisk / (packageData.disk + extraData.disk)) * 100) %>%"></div>
											</div>
											<span><%= serverDisk %> MB</span>
										</div>
									</td>
									<td class="py-3 px-4 md:px-6 hidden md:table-cell">
										<div class="flex items-center">
											<div class="w-full bg-gray-700 rounded-full h-2 mr-2 max-w-[100px]">
												<div class="bg-amber-500 h-2 rounded-full" style="width: <%= Math.round((serverCpu / (packageData.cpu + extraData.cpu)) * 100) %>%"></div>
											</div>
											<span><%= serverCpu %>%</span>
										</div>
									</td>
									<td class="py-3 px-4 md:px-6">
										<div class="flex items-center space-x-2">
											<a href="<%= server.panelUrl || '/panel' %>" target="_blank" class="p-1.5 bg-primary-500/10 hover:bg-primary-500/20 text-primary-400 rounded-lg transition-colors duration-200" title="Open Panel">
												<i class="fas fa-external-link-alt"></i>
											</a>
											<button class="p-1.5 bg-amber-500/10 hover:bg-amber-500/20 text-amber-400 rounded-lg transition-colors duration-200" title="Restart">
												<i class="fas fa-sync-alt"></i>
											</button>
											<button class="p-1.5 bg-red-500/10 hover:bg-red-500/20 text-red-400 rounded-lg transition-colors duration-200" title="Stop">
												<i class="fas fa-stop"></i>
											</button>
											<div class="relative group">
												<button class="p-1.5 bg-gray-700 hover:bg-gray-600 text-gray-400 rounded-lg transition-colors duration-200">
													<i class="fas fa-ellipsis-v"></i>
												</button>
												<div class="absolute right-0 mt-2 w-48 bg-dark-card rounded-lg shadow-lg border border-gray-700 hidden group-hover:block z-10">
													<ul class="py-1 text-sm">
														<li><a href="<%= server.panelUrl || '/panel' %>/console" class="block px-4 py-2 hover:bg-gray-700 text-gray-300">Console</a></li>
														<li><a href="<%= server.panelUrl || '/panel' %>/files" class="block px-4 py-2 hover:bg-gray-700 text-gray-300">File Manager</a></li>
														<li><a href="<%= server.panelUrl || '/panel' %>/backups" class="block px-4 py-2 hover:bg-gray-700 text-gray-300">Backups</a></li>
														<li><a href="#" class="block px-4 py-2 hover:bg-gray-700 text-red-400">Delete</a></li>
													</ul>
												</div>
											</div>
										</div>
									</td>
								</tr>
								<% } %>
								<% } else { %>
								<tr class="border-b border-gray-700">
									<td colspan="6" class="py-8 px-4 text-center text-gray-400">
										<div class="flex flex-col items-center">
											<i class="fas fa-server text-4xl mb-3 text-gray-600"></i>
											<p class="mb-2">You don't have any servers yet</p>
											<a href="/servers/new" class="btn-primary py-2 px-4 rounded-lg text-white flex items-center text-sm mt-3">
												<i class="fas fa-plus mr-2"></i>
												Create your first server
											</a>
										</div>
									</td>
								</tr>
								<% } %>
							</tbody>
						</table>
					</div>
					
					<div class="flex justify-between items-center mt-4 text-sm">
						<div class="text-gray-500">
							Showing <%= pterodactyl && pterodactyl.relationships && pterodactyl.relationships.servers && pterodactyl.relationships.servers.data ? pterodactyl.relationships.servers.data.length : 0 %> 
							of <%= pterodactyl && pterodactyl.relationships && pterodactyl.relationships.servers && pterodactyl.relationships.servers.data ? pterodactyl.relationships.servers.data.length : 0 %> servers
						</div>
						<div class="flex space-x-1">
							<button class="px-3 py-1 rounded bg-gray-800 text-gray-400 hover:bg-gray-700 transition-colors duration-200">Previous</button>
							<button class="px-3 py-1 rounded bg-primary-500 text-white hover:bg-primary-600 transition-colors duration-200">1</button>
							<button class="px-3 py-1 rounded bg-gray-800 text-gray-400 hover:bg-gray-700 transition-colors duration-200">Next</button>
						</div>
					</div>
				</div>
				
				<!-- Activity Feed -->
				<div class="glass-card rounded-xl border border-gray-700 p-6 mb-8">
					<div class="flex flex-col md:flex-row md:items-center justify-between mb-6">
						<h2 class="text-xl font-semibold flex items-center mb-3 md:mb-0">
							<i class="fas fa-history text-primary-400 mr-3"></i>
							Recent Activity
						</h2>
						<a href="/activity" class="text-sm text-primary-400 hover:text-primary-300 transition-colors duration-200 flex items-center">
							View all
							<i class="fas fa-chevron-right ml-1 text-xs"></i>
						</a>
					</div>
					
					<div class="space-y-4">
						<% 
						// Get real activities from the database or session if available
						const recentActivities = [];
						
						// Add server activities if servers exist
						if (pterodactyl && pterodactyl.relationships && pterodactyl.relationships.servers && pterodactyl.relationships.servers.data) {
							const servers = pterodactyl.relationships.servers.data;
							
							// Add server creation activity for the first server if it exists
							if (servers.length > 0) {
								recentActivities.push({
									type: 'server_created',
									icon: 'fas fa-server',
									iconBg: 'blue',
									title: 'Server Created',
									time: '2 hours ago',
									description: `You created a new server: "${servers[0].attributes.name}"`
								});
							}
							
							// Add server start activity
							if (servers.length > 0) {
								recentActivities.push({
									type: 'server_start',
									icon: 'fas fa-play',
									iconBg: 'green',
									title: 'Server Started',
									time: '10 minutes ago',
									description: `Your server "${servers[0].attributes.name}" has been started successfully.`
								});
							}
						}
						
						// Add login activity
						recentActivities.push({
							type: 'login',
							icon: 'fas fa-sign-in-alt',
							iconBg: 'purple',
							title: 'Account Login',
							time: '1 day ago',
							description: `You logged in from ${req.headers['user-agent'] || 'Unknown Device'}`
						});
						
						// Add resources activity if extra resources exist
						if (extraData && (extraData.ram > 0 || extraData.disk > 0 || extraData.cpu > 0)) {
							recentActivities.push({
								type: 'resources_added',
								icon: 'fas fa-coins',
								iconBg: 'amber',
								title: 'Resources Added',
								time: '3 days ago',
								description: `Added ${extraData.ram}MB RAM to your account`
							});
						}
						
						// Use a fallback if no activities are available
						const activities = recentActivities.length > 0 ? recentActivities : [
							{
								title: 'Server started',
								description: 'Your server "Web Hosting" has been started successfully.',
								time: '10 minutes ago',
								icon: 'fas fa-play',
								iconBg: 'green'
							},
							{
								title: 'Backup created',
								description: 'A new backup for "Database Server" has been created.',
								time: '2 hours ago',
								icon: 'fas fa-save',
								iconBg: 'blue'
							},
							{
								title: 'Server stopped',
								description: 'Your server "Test Environment" has been stopped.',
								time: '1 day ago',
								icon: 'fas fa-stop',
								iconBg: 'red'
							}
						];
						
						for(let activity of activities) { 
						%>
						<div class="flex items-start p-4 rounded-lg bg-gray-800 gap-4">
							<div class="w-10 h-10 flex-shrink-0 bg-<%= activity.iconBg %>-500/20 flex items-center justify-center mr-4 mt-1 flex-shrink-0">
								<i class="<%= activity.icon %> text-<%= activity.iconBg %>-400"></i>
							</div>
							<div class="flex-1 min-w-0">
								<p class="text-white font-medium"><%= activity.title %></p>
								<p class="text-sm text-gray-400"><%= activity.description %></p>
								<p class="text-xs text-gray-500 mt-1"><%= activity.time %></p>
							</div>
						</div>
						<% } %>
					</div>
				</div>
				
				<!-- System Status -->
				<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
					<!-- News & Updates -->
					<div class="bg-dark-card rounded-lg border border-gray-700 p-6">
						<h2 class="text-xl font-semibold mb-6">News & Updates</h2>
						<div class="text-gray-400 space-y-4">
							<div class="flex items-start gap-4">
								<div class="w-10 h-10 flex-shrink-0 bg-blue-900 rounded-full flex items-center justify-center">
									<i class="fas fa-bell text-blue-400"></i>
								</div>
								<div>
									<p class="text-white font-medium">Welcome to the new dashboard!</p>
									<p class="text-sm">We've completely redesigned our user interface for a better experience.</p>
									<p class="text-xs text-gray-500 mt-1">Just now</p>
								</div>
							</div>
							
							<div class="flex items-start gap-4">
								<div class="w-10 h-10 flex-shrink-0 bg-green-900 rounded-full flex items-center justify-center">
									<i class="fas fa-server text-green-400"></i>
								</div>
								<div>
									<p class="text-white font-medium">New server templates available</p>
									<p class="text-sm">Check out our new server templates in the Create Server section.</p>
									<p class="text-xs text-gray-500 mt-1">2 days ago</p>
								</div>
							</div>
							
							<div class="flex items-start gap-4">
								<div class="w-10 h-10 flex-shrink-0 bg-purple-900 rounded-full flex items-center justify-center">
									<i class="fas fa-rocket text-purple-400"></i>
								</div>
								<div>
									<p class="text-white font-medium">Performance improvements</p>
									<p class="text-sm">We've optimized our infrastructure for better server performance.</p>
									<p class="text-xs text-gray-500 mt-1">1 week ago</p>
								</div>
							</div>
						</div>
					</div>
					
					<!-- Help & Support -->
					<div class="bg-dark-card rounded-lg border border-gray-700 p-6">
						<h2 class="text-xl font-semibold mb-6">Help & Support</h2>
						<div class="space-y-4">
							<div class="p-4 rounded-lg bg-gray-800 flex items-start gap-4">
								<div class="w-10 h-10 flex-shrink-0 bg-amber-900 rounded-full flex items-center justify-center">
									<i class="fas fa-book text-amber-400"></i>
								</div>
								<div>
									<p class="text-white font-medium">Documentation</p>
									<p class="text-sm text-gray-400 mb-2">Check out our user guides and documentation for help.</p>
									<a href="#" class="text-blue-400 hover:text-blue-300 text-sm inline-flex items-center">
										View docs
										<svg class="w-3 h-3 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
											<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
										</svg>
									</a>
								</div>
							</div>
							
							<div class="p-4 rounded-lg bg-gray-800 flex items-start gap-4">
								<div class="w-10 h-10 flex-shrink-0 bg-blue-900 rounded-full flex items-center justify-center">
									<i class="fab fa-discord text-blue-400"></i>
								</div>
								<div>
									<p class="text-white font-medium">Join our Discord</p>
									<p class="text-sm text-gray-400 mb-2">Get support and chat with our community on Discord.</p>
									<a href="#" class="text-blue-400 hover:text-blue-300 text-sm inline-flex items-center">
										Join server
										<svg class="w-3 h-3 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
											<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
										</svg>
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</main>
	</div>
	
	<!-- Footer -->
	<footer>
		<div class="footer-content">
			<div class="flex flex-col md:flex-row justify-between items-center">
				<div class="mb-4 md:mb-0">
					<div class="flex items-center">
						<img src="./assets/img/FlaxyNodes_logo.gif" alt="Logo" class="h-8 mr-3 rounded-lg border border-gray-700 shadow-lg">
						<span class="text-lg font-semibold text-white">Flaxy Nodes</span>
					</div>
					<p class="text-gray-400 text-sm mt-2"> 2024 Flaxy Nodes. All rights reserved.</p>
					<span class="text-lg font-semibold text-gray-500">By Basai Corporation, Proudly Indian</span>
				</div>
				
				<div class="footer-links flex space-x-6">
					<a href="/terms" class="text-gray-400 hover:text-white transition-colors duration-200">Terms</a>
					<a href="/privacy" class="text-gray-400 hover:text-white transition-colors duration-200">Privacy</a>
					<a href="/contact" class="text-gray-400 hover:text-white transition-colors duration-200">Contact</a>
					<a href="https://discord.gg/<%= settings.discord.id %>" target="_blank" class="text-gray-400 hover:text-white transition-colors duration-200">
						<i class="fab fa-discord mr-1"></i> Discord
					</a>
				</div>
			</div>
		</div>
	</footer>
	
	<script>
		// Get all required elements
		const mobileMenuBtn = document.getElementById('mobileMenuBtn');
		const mobileSearchBtn = document.getElementById('mobileSearchBtn');
		const sidebar = document.querySelector('.sidebar');
		const mobileSearch = document.getElementById('mobileSearch');
		const dropdownMenu = document.getElementById('dropdownMenu');
		const dropdownBtn = document.getElementById('dropdownBtn');

		// Toggle sidebar
		mobileMenuBtn.addEventListener('click', (e) => {
			e.preventDefault();
			e.stopPropagation();
			sidebar.classList.toggle('active');
			mobileMenuBtn.classList.toggle('active');
			
			// Toggle icon between bars and times
			const icon = mobileMenuBtn.querySelector('i');
			if (sidebar.classList.contains('active')) {
				icon.classList.remove('fa-bars');
				icon.classList.add('fa-times');
				// Close other menus when opening sidebar
				dropdownMenu.classList.add('hidden');
			} else {
				icon.classList.remove('fa-times');
				icon.classList.add('fa-bars');
			}
		});

		// Toggle mobile search
		mobileSearchBtn.addEventListener('click', (e) => {
			e.preventDefault();
			e.stopPropagation();
			mobileSearch.classList.toggle('hidden');
			
			// Close other menus when opening search
			if (!mobileSearch.classList.contains('hidden')) {
				sidebar.classList.remove('active');
				mobileMenuBtn.classList.remove('active');
				const icon = mobileMenuBtn.querySelector('i');
				icon.classList.remove('fa-times');
				icon.classList.add('fa-bars');
				dropdownMenu.classList.add('hidden');
			}
		});

		// Close sidebar when clicking outside on mobile
		document.addEventListener('click', (e) => {
			const isClickInsideSidebar = sidebar.contains(e.target);
			const isClickOnMenuButton = mobileMenuBtn.contains(e.target);
			
			if (!isClickInsideSidebar && !isClickOnMenuButton && window.innerWidth < 768 && sidebar.classList.contains('active')) {
				sidebar.classList.remove('active');
				mobileMenuBtn.classList.remove('active');
				const icon = mobileMenuBtn.querySelector('i');
				icon.classList.remove('fa-times');
				icon.classList.add('fa-bars');
			}
		});

		// Close mobile search when clicking outside
		document.addEventListener('click', (e) => {
			const isClickInsideSearch = mobileSearch.contains(e.target);
			const isClickOnSearchButton = mobileSearchBtn.contains(e.target);
			
			if (!isClickInsideSearch && !isClickOnSearchButton && !mobileSearch.classList.contains('hidden')) {
				mobileSearch.classList.add('hidden');
			}
		});

		// Close sidebar on escape key
		document.addEventListener('keydown', (e) => {
			if (e.key === 'Escape') {
				if (sidebar.classList.contains('active')) {
					sidebar.classList.remove('active');
					mobileMenuBtn.classList.remove('active');
					const icon = mobileMenuBtn.querySelector('i');
					icon.classList.remove('fa-times');
					icon.classList.add('fa-bars');
				}
				mobileSearch.classList.add('hidden');
				dropdownMenu.classList.add('hidden');
			}
		});

		// Handle window resize
		window.addEventListener('resize', () => {
			if (window.innerWidth >= 768) {
				sidebar.classList.remove('active');
				mobileMenuBtn.classList.remove('active');
				const icon = mobileMenuBtn.querySelector('i');
				icon.classList.remove('fa-times');
				icon.classList.add('fa-bars');
				mobileSearch.classList.add('hidden');
			}
		});

		// Toggle dropdown menu
		dropdownBtn.addEventListener('click', (e) => {
			e.preventDefault();
			e.stopPropagation();
			dropdownMenu.classList.toggle('hidden');
			
			// Close other menus when opening dropdown
			if (!dropdownMenu.classList.contains('hidden')) {
				mobileSearch.classList.add('hidden');
				if (window.innerWidth < 768) {
					sidebar.classList.remove('active');
					mobileMenuBtn.classList.remove('active');
					const icon = mobileMenuBtn.querySelector('i');
					icon.classList.remove('fa-times');
					icon.classList.add('fa-bars');
				}
			}
		});

		// Close dropdown when clicking outside
		document.addEventListener('click', (e) => {
			if (!dropdownBtn.contains(e.target) && !dropdownMenu.contains(e.target)) {
				dropdownMenu.classList.add('hidden');
			}
		});

		// Prevent dropdown from closing when clicking inside it
		dropdownMenu.addEventListener('click', (e) => {
			e.stopPropagation();
		});

		// Add click event listeners to dropdown menu items
		dropdownMenu.querySelectorAll('a').forEach(link => {
			link.addEventListener('click', () => {
				dropdownMenu.classList.add('hidden');
			});
		});

		// Highlight active menu item
		document.addEventListener('DOMContentLoaded', () => {
			const currentPath = window.location.pathname;
			const menuItems = document.querySelectorAll('.menu-item');
			
			menuItems.forEach(item => {
				const href = item.getAttribute('href');
				if (href === currentPath) {
					item.classList.add('active');
				}
			});
		});
	</script>
</body>
</html>