<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title><%= extra.redeem.title %></title>
	<link rel="icon" type="image/png" href="<%= extra.faviconlink %>"/>
	
	<!-- Fonts and Icons -->
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	
	<!-- Tailwind CSS -->
	<script src="https://cdn.tailwindcss.com"></script>
	<script>
		tailwind.config = {
			darkMode: 'class',
			theme: {
				extend: {
					fontFamily: {
						sans: ['Inter', 'sans-serif'],
					},
					colors: {
						primary: {
							50: '#f0f9ff',
							100: '#e0f2fe',
							200: '#bae6fd',
							300: '#7dd3fc',
							400: '#38bdf8',
							500: '#0ea5e9',
							600: '#0284c7',
							700: '#0369a1',
							800: '#075985',
							900: '#0c4a6e',
							950: '#082f49',
						},
						dark: {
							base: '#111827',
							light: '#1F2937',
							lighter: '#374151',
							card: '#1E293B'
						}
					},
					animation: {
						'fade-in': 'fadeIn 0.5s ease-in-out',
						'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
					},
					keyframes: {
						fadeIn: {
							'0%': { opacity: '0' },
							'100%': { opacity: '1' },
						}
					}
				}
			}
		}
	</script>
	
	<style>
		body {
			background-color: #0f172a;
			color: #f1f5f9;
			font-family: 'Inter', sans-serif;
		}
		.navbar {
			background-color: rgba(15, 23, 42, 0.7);
			backdrop-filter: blur(10px);
			border-bottom: 1px solid rgba(148, 163, 184, 0.1);
		}
		.sidebar {
			background-color: #1e293b;
			border-right: 1px solid rgba(148, 163, 184, 0.1);
			transition: all 0.3s ease;
		}
		.card {
			background-color: #1e293b;
			border: 1px solid rgba(148, 163, 184, 0.1);
			transition: all 0.3s ease;
		}
		.card:hover {
			transform: translateY(-2px);
			box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
		}
		.gradient-border {
			position: relative;
			border-radius: 0.5rem;
			z-index: 0;
			overflow: hidden;
			padding: 1px;
		}
		.gradient-border::before {
			content: '';
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			border-radius: 0.5rem;
			padding: 2px;
			background: linear-gradient(45deg, #0ea5e9, #8b5cf6, #ec4899);
			-webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
			-webkit-mask-composite: xor;
			mask-composite: exclude;
			z-index: -1;
		}
		.main-content {
			animation: fadeIn 0.5s ease-in-out;
		}
		@keyframes fadeIn {
			0% { opacity: 0; }
			100% { opacity: 1; }
		}
		
		/* Custom Scrollbar */
		::-webkit-scrollbar {
			width: 8px;
		}
		::-webkit-scrollbar-track {
			background: #1e293b;
		}
		::-webkit-scrollbar-thumb {
			background: #475569;
			border-radius: 4px;
		}
		::-webkit-scrollbar-thumb:hover {
			background: #64748b;
		}
	</style>
</head>
<body class="min-h-screen">
	<%
		const userData = {
			id: userinfo.id,
			username: userinfo.username || userinfo.email.split('@')[0],
			email: userinfo.email,
			isAdmin: typeof req.session !== 'undefined' ? req.session.isAdmin : false
		};
	%>

	<!-- Navbar -->
	<nav class="navbar fixed w-full h-16 z-10 px-4 py-2.5 flex items-center justify-between">
		<div class="flex items-center">
			<button id="sidebarBtn" class="sm:hidden mr-2 text-gray-300 hover:text-white">
				<i class="fas fa-bars text-xl"></i>
			</button>
			<a href="/" class="flex items-center">
				<img src="<%= extra.faviconlink %>" class="h-8 mr-3" alt="Logo">
				<span class="self-center text-xl font-semibold whitespace-nowrap"><%= extra.home.name %></span>
			</a>
		</div>
		
		<div class="flex items-center gap-4">
			<div class="relative inline-block">
				<button id="dropdownBtn" class="flex items-center px-3 py-2 text-sm font-medium text-gray-300 rounded-lg hover:bg-gray-700 hover:text-white focus:outline-none">
					<span class="mr-2"><%= userData.username %></span>
					<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
					</svg>
				</button>
				<div id="dropdownMenu" class="hidden absolute right-0 mt-2 bg-gray-800 rounded-lg shadow-lg overflow-hidden z-20" style="min-width: 10rem;">
					<ul class="py-1 text-sm text-gray-200">
						<li>
							<a href="/settings" class="block px-4 py-2 hover:bg-gray-700">Settings</a>
						</li>
						<% if (userData.isAdmin) { %>
						<li>
							<a href="/admin" class="block px-4 py-2 hover:bg-gray-700">Admin Panel</a>
						</li>
						<% } %>
						<li>
							<a href="/auth/logout" class="block px-4 py-2 hover:bg-gray-700 text-red-400">Logout</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</nav>
	
	<!-- Sidebar and Main Content -->
	<div class="flex h-screen pt-16">
		<!-- Sidebar -->
		<aside id="sidebar" class="fixed left-0 top-16 h-full z-10 w-64 transition-transform -translate-x-full sm:translate-x-0">
			<div class="h-full px-3 pb-4 overflow-y-auto sidebar">
				<ul class="space-y-2 pt-4 font-medium">
					<li>
						<a href="/dashboard" class="flex items-center p-3 text-gray-300 rounded-lg hover:bg-gray-700 group">
							<i class="fas fa-gauge-high w-5 h-5 text-gray-400 group-hover:text-white transition duration-75"></i>
							<span class="ms-3">Dashboard</span>
						</a>
					</li>
					<li>
						<a href="/servers" class="flex items-center p-3 text-gray-300 rounded-lg hover:bg-gray-700 group">
							<i class="fas fa-server w-5 h-5 text-gray-400 group-hover:text-white transition duration-75"></i>
							<span class="ms-3">My Servers</span>
						</a>
					</li>
					<li>
						<a href="/create" class="flex items-center p-3 text-gray-300 rounded-lg hover:bg-gray-700 group">
							<i class="fas fa-plus w-5 h-5 text-gray-400 group-hover:text-white transition duration-75"></i>
							<span class="ms-3">Create Server</span>
						</a>
					</li>
					<li>
						<a href="/store" class="flex items-center p-3 text-gray-300 rounded-lg hover:bg-gray-700 group">
							<i class="fas fa-shopping-cart w-5 h-5 text-gray-400 group-hover:text-white transition duration-75"></i>
							<span class="ms-3">Resource Store</span>
						</a>
					</li>
					<li>
						<a href="/redeem" class="flex items-center p-3 text-white rounded-lg bg-primary-600 group">
							<i class="fas fa-gift w-5 h-5 text-white transition duration-75"></i>
							<span class="ms-3">Redeem Coupon</span>
						</a>
					</li>
				</ul>
			</div>
		</aside>
		
		<!-- Main Content -->
		<div class="p-4 sm:ml-64 pt-5 w-full main-content">
			<div class="p-4">
				<!-- Page Header -->
				<div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
					<div>
						<h1 class="text-3xl font-bold mb-2">Redeem Coupon</h1>
						<p class="text-gray-400">Enter your coupon code to redeem resources.</p>
					</div>
					<div class="mt-4 md:mt-0 flex items-center gap-4">
						<div class="bg-gray-800 px-4 py-2 rounded-lg">
							<span class="text-sm text-gray-400">Current Balance</span>
							<div class="flex items-center">
								<i class="fas fa-coins text-yellow-400 mr-2"></i>
								<span class="text-lg font-semibold text-white"><%= typeof coins !== 'undefined' ? coins : 0 %></span>
							</div>
						</div>
					</div>
				</div>
				
				<!-- Main Content -->
				<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
					<!-- Redeem Form Card -->
					<div class="card p-6">
						<div class="flex items-center space-x-3 mb-6">
							<div class="p-3 rounded-lg bg-primary-500/10">
								<i class="fas fa-gift text-2xl text-primary-400"></i>
							</div>
							<div>
								<h2 class="text-xl font-semibold text-white">Redeem Your Code</h2>
								<p class="text-gray-400">Enter your coupon code below to receive resources.</p>
							</div>
						</div>
						
						<form action="/redeem" method="POST" class="space-y-6">
							<div>
								<label for="code" class="block text-sm font-medium text-gray-300 mb-2">Coupon Code</label>
								<div class="relative">
									<input type="text" id="code" name="code" required
										class="w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-primary-500"
										placeholder="Enter your coupon code">
									<div class="absolute inset-y-0 right-0 flex items-center pr-4">
										<i class="fas fa-ticket-alt text-gray-400"></i>
									</div>
								</div>
							</div>
							
							<button type="submit" class="w-full inline-flex items-center justify-center px-5 py-2.5 bg-primary-600 hover:bg-primary-700 focus:ring-4 focus:ring-primary-800 font-medium rounded-lg text-sm">
								<i class="fas fa-gift mr-2"></i>
								Redeem Code
							</button>
						</form>
						
						<!-- Error Messages -->
						<% if (req.query.err) { %>
							<div class="mt-6 p-4 bg-red-500/10 border border-red-500/20 rounded-lg">
								<div class="flex items-center">
									<i class="fas fa-exclamation-circle text-red-400 mr-3"></i>
									<div>
										<h3 class="text-sm font-medium text-red-400">Error</h3>
										<p class="text-sm text-red-300 mt-1">
											<% if (req.query.err === "MISSINGCOUPONCODE") { %>
												You have not provided the coupon code.
											<% } else if (req.query.err === "INVALIDCOUPONCODE") { %>
												Could not find coupon with the provided code.
											<% } else if (req.query.err === "SUCCESSCOUPONCODE") { %>
												You have successfully applied a coupon code.
											<% } else { %>
												An error occurred while redeeming your code.
											<% } %>
										</p>
									</div>
								</div>
							</div>
						<% } %>
					</div>
					
					<!-- Information Card -->
					<div class="card p-6">
						<div class="flex items-center space-x-3 mb-6">
							<div class="p-3 rounded-lg bg-blue-500/10">
								<i class="fas fa-info-circle text-2xl text-blue-400"></i>
							</div>
							<div>
								<h2 class="text-xl font-semibold text-white">About Coupons</h2>
								<p class="text-gray-400">Learn how coupons work and where to get them.</p>
							</div>
						</div>
						
						<div class="space-y-6">
							<div>
								<h3 class="text-sm font-semibold text-white mb-2">How It Works</h3>
								<p class="text-sm text-gray-400">
									Coupons are a great way to get free resources for your servers. Simply enter your code in the form on the left, and the resources will be instantly added to your account.
								</p>
							</div>
							
							<div>
								<h3 class="text-sm font-semibold text-white mb-2">Where to Get Coupons</h3>
								<p class="text-sm text-gray-400">
									Coupons can be purchased from our official store or received as rewards for participating in community events.
								</p>
							</div>
							
							<div>
								<h3 class="text-sm font-semibold text-white mb-2">Important Notes</h3>
								<ul class="space-y-2 text-sm text-gray-400">
									<li class="flex items-center">
										<i class="fas fa-check text-green-400 mr-2"></i>
										Codes can only be used once
									</li>
									<li class="flex items-center">
										<i class="fas fa-check text-green-400 mr-2"></i>
										Codes expire after 30 days
									</li>
									<li class="flex items-center">
										<i class="fas fa-check text-green-400 mr-2"></i>
										Resources are added instantly
									</li>
								</ul>
							</div>
							
							<div class="pt-6 border-t border-gray-700">
								<h3 class="text-sm font-semibold text-white mb-2">Need Help?</h3>
								<p class="text-sm text-gray-400 mb-4">
									If you're having trouble redeeming your coupon, please contact our support team.
								</p>
								<a href="/support" class="inline-flex items-center justify-center px-5 py-2.5 bg-gray-700 hover:bg-gray-600 focus:ring-4 focus:ring-gray-800 font-medium rounded-lg text-sm">
									<i class="fas fa-headset mr-2"></i>
									Contact Support
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<script>
		// Dropdown menu toggle
		const dropdownBtn = document.getElementById('dropdownBtn');
		const dropdownMenu = document.getElementById('dropdownMenu');
		
		dropdownBtn.addEventListener('click', () => {
			dropdownMenu.classList.toggle('hidden');
		});
		
		// Close dropdown when clicking outside
		document.addEventListener('click', (event) => {
			if (!dropdownBtn.contains(event.target) && !dropdownMenu.contains(event.target)) {
				dropdownMenu.classList.add('hidden');
			}
		});
		
		// Mobile sidebar toggle
		const sidebarBtn = document.getElementById('sidebarBtn');
		const sidebar = document.getElementById('sidebar');
		
		if (sidebarBtn) {
			sidebarBtn.addEventListener('click', () => {
				sidebar.classList.toggle('-translate-x-full');
			});
		}
		
		// Form validation
		const form = document.querySelector('form');
		const codeInput = document.getElementById('code');
		
		form.addEventListener('submit', (e) => {
			if (!codeInput.value.trim()) {
				e.preventDefault();
				codeInput.classList.add('border-red-500');
				alert('Please enter a coupon code.');
			} else {
				codeInput.classList.remove('border-red-500');
			}
		});
	</script>
</body>
</html>