<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - <%= settings.website.name %></title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            50: '#eef2ff',
                            100: '#e0e7ff',
                            200: '#c7d2fe',
                            300: '#a5b4fc',
                            400: '#818cf8',
                            500: '#6366f1',
                            600: '#4f46e5',
                            700: '#4338ca',
                            800: '#3730a3',
                            900: '#312e81',
                            950: '#1e1b4b',
                        },
                        dark: {
                            base: '#0f0f12',
                            light: '#1a1a21',
                            lighter: '#24242e',
                            card: '#1a1a21'
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-dark-base text-white min-h-screen flex items-center justify-center p-4">
    <div class="w-full max-w-md">
        <!-- Background Effects -->
        <div class="absolute inset-0 z-0">
            <div class="absolute top-0 right-0 w-1/2 h-1/2 bg-primary-900/20 rounded-full blur-3xl transform translate-x-1/3 -translate-y-1/3"></div>
            <div class="absolute bottom-0 left-0 w-1/2 h-1/2 bg-primary-800/20 rounded-full blur-3xl transform -translate-x-1/3 translate-y-1/3"></div>
        </div>

        <!-- Register Card -->
        <div class="bg-dark-light rounded-xl p-8 relative z-10 shadow-xl shadow-primary-900/10">
            <!-- Logo -->
            <div class="text-center mb-8">
                <img src="./assets/img/SriyanNodes_Logo.gif" alt="Sriyan Nodes Logo" class="h-16 w-16 mx-auto rounded-full mb-4">
                <h1 class="text-2xl font-bold">Sriyan<span class="text-primary-500">Nodes</span></h1>
            </div>

            <!-- Auth Tabs -->
            <div class="flex justify-center mb-8">
                <div class="bg-dark-base p-1 rounded-lg">
                    <div class="flex space-x-1">
                        <a href="/login" class="px-4 py-2 text-sm font-medium rounded-md text-gray-300 hover:text-white transition-colors">Login</a>
                        <a href="/register" class="px-4 py-2 text-sm font-medium rounded-md bg-primary-600 text-white">Register</a>
                    </div>
                </div>
            </div>

            <!-- Register Form -->
            <form id="registerForm" class="space-y-6">
                <div>
                    <label for="username" class="block text-sm font-medium text-gray-300 mb-2">Username</label>
                    <input type="text" id="username" name="username" required
                        class="w-full px-4 py-3 bg-dark-base border border-dark-lighter rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-white placeholder-gray-400"
                        placeholder="Choose a username">
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="firstName" class="block text-sm font-medium text-gray-300 mb-2">First Name</label>
                        <input type="text" id="firstName" name="firstName" required
                            class="w-full px-4 py-3 bg-dark-base border border-dark-lighter rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-white placeholder-gray-400"
                            placeholder="Enter first name">
                    </div>

                    <div>
                        <label for="lastName" class="block text-sm font-medium text-gray-300 mb-2">Last Name</label>
                        <input type="text" id="lastName" name="lastName" required
                            class="w-full px-4 py-3 bg-dark-base border border-dark-lighter rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-white placeholder-gray-400"
                            placeholder="Enter last name">
                    </div>
                </div>

                <div>
                    <label for="email" class="block text-sm font-medium text-gray-300 mb-2">Email</label>
                    <input type="email" id="email" name="email" required
                        class="w-full px-4 py-3 bg-dark-base border border-dark-lighter rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-white placeholder-gray-400"
                        placeholder="Enter your email">
                </div>

                <div>
                    <label for="password" class="block text-sm font-medium text-gray-300 mb-2">Password</label>
                    <input type="password" id="password" name="password" required
                        class="w-full px-4 py-3 bg-dark-base border border-dark-lighter rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-white placeholder-gray-400"
                        placeholder="Create a password">
                </div>

                <div>
                    <label for="confirmPassword" class="block text-sm font-medium text-gray-300 mb-2">Confirm Password</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" required
                        class="w-full px-4 py-3 bg-dark-base border border-dark-lighter rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-white placeholder-gray-400"
                        placeholder="Confirm your password">
                </div>

                <div class="flex items-center">
                    <input type="checkbox" id="agree" name="agree" required
                        class="h-4 w-4 text-primary-600 focus:ring-primary-500 border-dark-lighter rounded">
                    <label for="agree" class="ml-2 block text-sm text-gray-300">I agree to the <a href="/terms" class="text-primary-400 hover:text-primary-300">Terms & Conditions</a></label>
                </div>

                <button type="submit"
                    class="w-full py-3 px-4 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 focus:ring-offset-dark-base">
                    Register
                </button>

                <!-- Discord Register -->
                <div class="relative">
                    <div class="absolute inset-0 flex items-center">
                        <div class="w-full border-t border-dark-lighter"></div>
                    </div>
                    <div class="relative flex justify-center text-sm">
                        <span class="px-2 bg-dark-light text-gray-400">Or continue with</span>
                    </div>
                </div>

                <a href="/auth/discord"
                    class="w-full py-3 px-4 bg-[#5865F2] hover:bg-[#4752C4] text-white font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-[#5865F2] focus:ring-offset-2 focus:ring-offset-dark-base flex items-center justify-center">
                    <i class="fab fa-discord mr-2"></i>
                    Register with Discord
                </a>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-4 right-4 bg-dark-light text-white px-6 py-3 rounded-lg shadow-lg transform translate-y-full opacity-0 transition-all duration-300">
        <p id="toastMessage"></p>
    </div>

    <script>
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const agree = document.getElementById('agree').checked;

            if (!agree) {
                showToast('Please agree to the Terms & Conditions');
                return;
            }

            if (password !== confirmPassword) {
                showToast('Passwords do not match');
                return;
            }

            try {
                const response = await fetch('/auth/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        username,
                        firstName,
                        lastName,
                        email, 
                        password
                    }),
                });

                const data = await response.json();

                if (data.success) {
                    window.location.href = '/dashboard';
                } else {
                    showToast(data.error || 'Registration failed');
                }
            } catch (error) {
                showToast('An error occurred. Please try again.');
            }
        });

        function showToast(message) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toastMessage.textContent = message;
            toast.classList.remove('translate-y-full', 'opacity-0');
            
            setTimeout(() => {
                toast.classList.add('translate-y-full', 'opacity-0');
            }, 3000);
        }
    </script>
</body>
</html> 